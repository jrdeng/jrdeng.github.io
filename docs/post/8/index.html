<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>Lua 5.4.x CMakeLists.txt | 无名的博客</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="https://unpkg.com/normalize.css"><link rel="stylesheet" type="text/css" href="https://unpkg.com/purecss/build/pure-min.css"><link rel="stylesheet" type="text/css" href="https://unpkg.com/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="https://unpkg.com/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="https://unpkg.com/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="https://unpkg.com/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="https://unpkg.com/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="https://unpkg.com/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Lua 5.4.x CMakeLists.txt</h1><a id="logo" href="/.">无名的博客</a><p class="description">我有平生事 只与明月听</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Lua 5.4.x CMakeLists.txt</h1><div class="post-meta">2020-10-30</div><div class="post-content"><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cmake_minimum_required</span>(VERSION <span class="number">3.12</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">project</span>(Lua)</span><br><span class="line"></span><br><span class="line"><span class="built_in">add_definitions</span>(-DLUA_COMPAT_5_3)</span><br><span class="line"><span class="built_in">if</span>(UNIX)</span><br><span class="line">    <span class="built_in">add_definitions</span>(-DLUA_USE_LINUX)</span><br><span class="line"><span class="built_in">endif</span>(UNIX)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### force options</span><br><span class="line"><span class="built_in">if</span>(WIN32)</span><br><span class="line">    <span class="built_in">add_compile_options</span>(&quot;$&lt;$&lt;C_COMPILER_ID:MSVC&gt;:/utf-<span class="number">8</span>&gt;&quot;)</span><br><span class="line">    <span class="built_in">add_compile_options</span>(&quot;$&lt;$&lt;CXX_COMPILER_ID:MSVC&gt;:/utf-<span class="number">8</span>&gt;&quot;)</span><br><span class="line"><span class="built_in">endif</span>()</span><br><span class="line"></span><br><span class="line"># see https://www.lua.org/manual/<span class="number">5.4</span>/readme.html#other</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### build lib</span><br><span class="line"><span class="built_in">set</span>(C_FILES lapi.c lcode.c lctype.c ldebug.c ldo.c ldump.c lfunc.c lgc.c llex.c lmem.c lobject.c lopcodes.c lparser.c lstate.c lstring.c ltable.c ltm.c lundump.c lvm.c lzio.c lauxlib.c lbaselib.c lcorolib.c ldblib.c liolib.c lmathlib.c loadlib.c loslib.c lstrlib.c ltablib.c lutf8lib.c linit.c)</span><br><span class="line"># prepend <span class="string">&#x27;src/&#x27;</span></span><br><span class="line"><span class="built_in">list</span>(TRANSFORM C_FILES PREPEND <span class="string">&quot;src/&quot;</span>)</span><br><span class="line"># in C++ style</span><br><span class="line"><span class="built_in">set_source_files_properties</span>($&#123;C_FILES&#125; PROPERTIES LANGUAGE CXX)</span><br><span class="line"><span class="built_in">add_library</span>(lua STATIC $&#123;C_FILES&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### build interpreter</span><br><span class="line"><span class="built_in">set</span>(C_FILES &quot;src/lua.c&quot;)</span><br><span class="line"><span class="built_in">set_source_files_properties</span>($&#123;C_FILES&#125; PROPERTIES LANGUAGE CXX)</span><br><span class="line"><span class="built_in">add_executable</span>(lua-interpreter $&#123;C_FILES&#125;)</span><br><span class="line"><span class="built_in">target_link_libraries</span>(lua-interpreter lua)</span><br><span class="line"><span class="built_in">if</span>(UNIX)</span><br><span class="line">    <span class="built_in">target_link_libraries</span>(lua-interpreter m dl)</span><br><span class="line"><span class="built_in">endif</span>(UNIX)</span><br><span class="line"><span class="built_in">set_target_properties</span>(lua-interpreter PROPERTIES OUTPUT_NAME lua)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### build compiler</span><br><span class="line"><span class="built_in">set</span>(C_FILES &quot;src/luac.c&quot;)</span><br><span class="line"><span class="built_in">set_source_files_properties</span>($&#123;C_FILES&#125; PROPERTIES LANGUAGE CXX)</span><br><span class="line"><span class="built_in">add_executable</span>(luac $&#123;C_FILES&#125;)</span><br><span class="line"><span class="built_in">target_link_libraries</span>(luac lua)</span><br><span class="line"><span class="built_in">if</span>(UNIX)</span><br><span class="line">    <span class="built_in">target_link_libraries</span>(luac m dl)</span><br><span class="line"><span class="built_in">endif</span>(UNIX)</span><br><span class="line"></span><br><span class="line"># install target</span><br><span class="line"><span class="built_in">install</span>(TARGETS lua</span><br><span class="line">    RUNTIME DESTINATION lib</span><br><span class="line">    LIBRARY DESTINATION lib</span><br><span class="line">    ARCHIVE DESTINATION lib</span><br><span class="line">)</span><br><span class="line"><span class="built_in">install</span>(TARGETS lua-interpreter luac</span><br><span class="line">    RUNTIME DESTINATION bin</span><br><span class="line">)</span><br><span class="line"><span class="built_in">install</span>(FILES src/lua.hpp src/lua.h src/lualib.h src/lauxlib.h src/luaconf.h</span><br><span class="line">    DESTINATION include</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<hr style="width: 100%"/>

<h1 style="font-size: 1.5em;color:#555;font-weight: bold;">Comments: (on <a target="_blank" rel="noopener" href="https://github.com/jrdeng/jrdeng.github.io/issues/8">github issue)</a></h1>


<script src="https://utteranc.es/client.js"
        repo="jrdeng/jrdeng.github.io"
        issue-number="8"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</div><div class="tags"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Lua/" rel="tag">Lua</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">技术</a></li></ul></div><div class="post-nav"><a class="pre" href="/post/9/">KVM/libvirt forwarding ports to guest via iptables</a><a class="next" href="/post/7/">解决Windows不能远程登录ubuntu18.04.2（xRDP）的问题</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="关于"><img class="nofancybox" src="/img/avatar.png"/></a><p>My Life is Getting Better(MLGB).</p><a class="info-icon" href="mailto:junren.deng@gmail.com" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/jrdeng" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Github-Actions/" style="font-size: 15px;">Github Actions</a> <a href="/tags/IPv6/" style="font-size: 15px;">IPv6</a> <a href="/tags/Debian/" style="font-size: 15px;">Debian</a> <a href="/tags/apt/" style="font-size: 15px;">apt</a> <a href="/tags/Nextcloud/" style="font-size: 15px;">Nextcloud</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/Ubuntu/" style="font-size: 15px;">Ubuntu</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/%E6%B5%8B%E8%AF%95%E6%A0%87%E7%AD%BE/" style="font-size: 15px;">测试标签</a> <a href="/tags/%E6%8A%80%E6%9C%AF/" style="font-size: 15px;">技术</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/hugo/" style="font-size: 15px;">hugo</a> <a href="/tags/GraphQL/" style="font-size: 15px;">GraphQL</a> <a href="/tags/WSL/" style="font-size: 15px;">WSL</a> <a href="/tags/NAS/" style="font-size: 15px;">NAS</a> <a href="/tags/%E9%A3%9E%E7%89%9B/" style="font-size: 15px;">飞牛</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 15px;">笔记</a> <a href="/tags/tailscale/" style="font-size: 15px;">tailscale</a> <a href="/tags/ComfyUI/" style="font-size: 15px;">ComfyUI</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/xRDP/" style="font-size: 15px;">xRDP</a> <a href="/tags/Lua/" style="font-size: 15px;">Lua</a> <a href="/tags/KVM/" style="font-size: 15px;">KVM</a> <a href="/tags/iptables/" style="font-size: 15px;">iptables</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/post/29/">改用Hexo了</a></li><li class="post-list-item"><a class="post-list-link" href="/post/28/">一些可能有用的东西</a></li><li class="post-list-item"><a class="post-list-link" href="/post/27/">记录一次飞牛OS升级后Docker启动失败</a></li><li class="post-list-item"><a class="post-list-link" href="/post/25/">给docker daemon设置代理</a></li><li class="post-list-item"><a class="post-list-link" href="/post/24/">WSL里的Ubuntu/Debian因为时间不同步报错</a></li><li class="post-list-item"><a class="post-list-link" href="/post/23/">WSL无法使用ping命令</a></li><li class="post-list-item"><a class="post-list-link" href="/post/22/">WSL里docker启动失败</a></li><li class="post-list-item"><a class="post-list-link" href="/post/21/">GCC Instrumentation Options</a></li><li class="post-list-item"><a class="post-list-link" href="/post/20/">Windows 11家庭版安装WSL</a></li><li class="post-list-item"><a class="post-list-link" href="/post/19/">Where is the core dump?</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://l2m2.top/" title="L2M2" target="_blank">L2M2</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2025 <a href="/." rel="nofollow">无名的博客.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="https://unpkg.com/@fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="https://unpkg.com/@fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="复制成功！"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>